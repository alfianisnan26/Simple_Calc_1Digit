	;Kelompok	: Cherry Trail
	;Topik		: 15
	;Kelas		: SBK-01
	;Anggota	: 
	;•	Alfian Badrul Isnan	- 1806148643
	;•	Nadhifa Khalista - 1806148800
	;•	Natalia Kristian – 1806200103
	;BUTTON A + (ADD)
	;BUTTON B - (SUB)
	;BUTTON C CLEAR
	;BUTTOM D CLEAR
	;R0 SHIFT REGISTER FOR PORT 2
	;P2 -> 0-3 BUTTON, 4-7 DISPLAY
	;KEYPAD INTERFACING
	;P0.0	1	2	3	A
	;P0.1	4	5	6	B
	;P0.2	7	8	9	C
	;P0.3	*	0	#	D
	;	P2.3	P2.2	P2.1	P2.0
	;4-DIGIT LED 7SEG
	;P2.4
	;P2.5
	;-
	;-
	;	P1.0 - P1.7
ORG 0H
	MOV P0, #FBIT ;IINPUT KEYPAD
	MOV R0, #0 ;COUNTER
	MOV R1, #0 ;REGISTER TO SAVE LAST DIGIT1
	MOV R2, #0 ;REGISTER TO SAVE LAST DIGIT2
	MOV R3, #0 ;REGISTER TO SAVE LAST DIGIT3
	MOV R4, #0 ;REGISTER TO SAVE LAST DIGIT4
	MOV 18H, #1
	;BANK 2
	;R0 DIGIT COUNTER
	;R1 COUNTER
	;R2 LAST INPUT READ
	;R3 VARIABLE
	;R4 VARIABLE
	MOV DPTR, #SEG
LOOP:	ACALL CHECK
	SJMP LOOP
	MOV B, P0
CHECK:	SETB RS1
	SETB RS0
;;;;;;;;;;;;;;;;;;;;;;;;;
	MOV P2, #11111110B
	MOV B, P0
	MOV A, 13H
	CJNE A, B, ISD4
	SJMP NOTD1
ISD4:	MOV 13H, B
	MOV R2, B
	CJNE R2, #0FEH, NOTA	;ISA ;11111110
	MOV R0, #4
	MOV A, 1
	MOV B, 2
	ADD A, B
	MOV B, #0AH
	DIV AB
	MOV 3H, A
	CJNE A, #0, ISNZE
	MOV 3H, #10
ISNZE:	MOV 4H, B
	LJMP DISP
NOTA:	CJNE R2, #0FDH, NOTB	;ISB ;11111101
	MOV R0, #4
	MOV A, 1
	MOV B, 2
	SUBB A, B
	MOV 3, #10
	JNC ASSIGN
	CLR C
	CLR AC
	CPL A
	INC A
	MOV 3, #11
ASSIGN: MOV 4, A
	LJMP DISP
NOTB:	CJNE R2, #0FBH, NOTC	;ISC ;11111011
	MOV R0, #1
	LJMP DISP
NOTC:	CJNE R2, #0F7H, NOTD1	;ISD ;11110111
	MOV R0, #1
	LJMP DISP
;;;;;;;;;;;;;;;;;;;;;;;;;
NOTD1:	CJNE R0, #3, ISD2T
	LJMP DISP
ISD2T:	MOV P2, #11111101B
	MOV B, P0
	MOV A, 12H
	CJNE A, B, ISD3
	SJMP NOTD2
ISD3:	MOV 12H, B
	MOV R2, B
	CJNE R2, #0FEH, NOT3	;IS 3
	MOV A, #3
	SJMP SETD
NOT3:	CJNE R2, #0FDH, NOT6	;IS 6
	MOV A, #6
	SJMP SETD
NOT6:	CJNE R2, #0FBH, NOTD2	;IS 9
	MOV A, #9
	SJMP SETD
;;;;;;;;;;;;;;;;;;;;;;;;;
NOTD2:	MOV P2, #11111011B
	MOV B, P0
	MOV A, 11H
	CJNE A, B, ISD2
	SJMP NOTD3
ISD2:	MOV 11H, B
	MOV R2, B
	CJNE R2, #0FEH, NOT2	;IS 2
	MOV A, #2
	SJMP SETD
NOT2:	CJNE R2, #0FDH, NOT5	;IS 5
	MOV A, #5
	SJMP SETD
NOT5:	CJNE R2, #0FBH, NOT8	;IS 8
	MOV A, #8
	SJMP SETD
NOT8:	CJNE R2, #0F7H, NOTD3	;IS 0
	MOV A, #0
	SJMP SETD
;;;;;;;;;;;;;;;;;;;;;;;;;
NOTD3:	MOV P2, #11110111B
	MOV B, P0
	MOV A, 10H
	CJNE A, B, ISD1
	SJMP DISP
ISD1:	MOV 10H, B
	MOV R2, B
	CJNE R2, #0FEH, NOT1 	;IS 1
	MOV A, #1
	SJMP SETD
NOT1:	CJNE R2, #0FDH, NOT4	;IS 4
	MOV A, #4
	SJMP SETD
NOT4:	CJNE R2, #0FBH, DISP	;IS 7
	MOV A, #7
	SJMP SETD
SETD:	CJNE R0, #4, SETDN
	MOV R0, #1
SETDN:	MOV @R0, A
	INC R0
;;;;;;;;;;;;;;;;;;;;;;;;;
DISP:	CLR RS1
	CLR RS0
	MOV R0, 18H
	DEC R0
	MOV A, R0
	CPL A
	MOV P3, A
	CJNE R0, #0, LDISP1
	SJMP WRET
LDISP1:	MOV R5, #1
	MOV P2, #11110111B
	CJNE R0, #3, LDISP2
	MOV R0, #4H
	MOV R5, #2
LDISP2:	MOV A, @R0
	MOVC A, @A+DPTR
	DEC R0
	DEC R5
	MOV B, A
	MOV P1, #FBIT
	MOV A, P2
	RL A
	MOV P2, A
	MOV P1, B
	CJNE R5, #0, LDISP2
WRET:	RET
ORG 1A0H
;COMMON ANODE 7SEG
SEG: 	DB 0xC0;0
	DB 0xF9;1
	DB 0xA4;2
	DB 0xB0;3
	DB 0x99;4
	DB 0x92;5
	DB 0x82;6
	DB 0xF8;7
	DB 0x80;8
	DB 0x90;9
	DB FBIT;NULL
	DB 0xBF;NEGATIVE SIGN
FBIT EQU 0xFF
END
